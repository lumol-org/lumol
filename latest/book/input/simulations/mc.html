<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Monte Carlo &#8212; Lumol 0.0.0 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/lumol.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Modifying lumol" href="../../advanced/index.html" />
    <link rel="prev" title="Molecular dynamics" href="md.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          Lumol</a>
        <span class="navbar-text navbar-version pull-left"><b>0.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Navigation <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/index.html">Lumol concepts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Input file reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced/index.html">Modifying lumol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="md.html" title="Previous Chapter: Molecular dynamics"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Molecular dynamics</span>
    </a>
  </li>
  <li>
    <a href="../../advanced/index.html" title="Next Chapter: Modifying lumol"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Modifying lumol &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/index.html">Lumol concepts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Input file reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../input.html"><code class="docutils literal notranslate"><span class="pre">[input]</span></code> section</a></li>
<li class="toctree-l2"><a class="reference internal" href="../log.html"><code class="docutils literal notranslate"><span class="pre">[log]</span></code> section</a></li>
<li class="toctree-l2"><a class="reference internal" href="../systems/index.html"><code class="docutils literal notranslate"><span class="pre">[[systems]]</span></code> section</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/index.html">Interactions input</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html"><code class="docutils literal notranslate"><span class="pre">[[simulations]]</span></code> section</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="output.html">Specifying output information</a></li>
<li class="toctree-l3"><a class="reference internal" href="min.html">Minimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="md.html">Molecular dynamics</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Monte Carlo</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced/index.html">Modifying lumol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
</ul>

<form action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="section" id="monte-carlo">
<span id="id1"></span><h1>Monte Carlo<a class="headerlink" href="#monte-carlo" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li>Needed keys:<ul>
<li><code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">&quot;MonteCarlo&quot;</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">temperature</span></code> (string): System temperature. The string contains the
temperature with unit.</li>
</ul>
</li>
<li>Optional keys:<ul>
<li><code class="docutils literal notranslate"><span class="pre">update_frequency</span></code> (positive integer): After this number of steps of a
move, <code class="docutils literal notranslate"><span class="pre">delta</span></code> values for this move are updated.  Updates use statistics
of a moves’ acceptance ratio so it is recommended to choose a sufficiently
high number (&gt;100).</li>
</ul>
</li>
</ul>
<p>If you want to perform a Monte Carlo simulation, you have to set the propagator
<code class="docutils literal notranslate"><span class="pre">type</span></code> to <code class="docutils literal notranslate"><span class="pre">&quot;MonteCarlo&quot;</span></code>. Every Monte Carlo simulations needs a
<code class="docutils literal notranslate"><span class="pre">temperature</span></code> and a set of <code class="docutils literal notranslate"><span class="pre">moves</span></code> (this set can consist of a single move).</p>
<p>You can think of a “move” as a specific instruction to generate a new trial
configuration. For example: “translate a single molecule in the system”, “rotate
a molecule”, or “change the cell size”. If a move is accepted (based on an
acceptance criterion), the trial configuration becomes the new configuration. If
the move is rejected, the system stays in its current configuration. You can add
multiple moves so that the ensemble of your choice is sampled.</p>
<p>Here is a list of all moves that are currently implemented in Lumol:</p>
<ul class="simple">
<li><a class="reference internal" href="#mcmove-translate"><span class="std std-ref">Translate</span></a>: Change the center of mass position of a molecule.</li>
<li><a class="reference internal" href="#mcmove-rotate"><span class="std std-ref">Rotate</span></a>: Perform a rotation of a molecule about its center of
mass.</li>
<li><a class="reference internal" href="#mcmove-resize"><span class="std std-ref">Resize</span></a>: Change the size of the simulation cell.</li>
</ul>
<p>Currently, all Monte Carlo simulations are carried out using Metropolis
acceptance criteria.</p>
<p>You can add all necessary information after the <code class="docutils literal notranslate"><span class="pre">[simulations.propagator]</span></code>
label.</p>
<p>Naturally, Monte Carlo simulations are carried out at constant temperature which
is set using the <code class="docutils literal notranslate"><span class="pre">temperature</span></code> key.</p>
<p>Different from Molecular Dynamics, Monte Carlo simulations don’t carry
information about the velocities of particles. As a consequence we cannot access
temperature from the kinetic energy.</p>
<p><strong>Example</strong></p>
<p>A sample input for a Monte Carlo simulation (in the NPT ensemble) can look like
so:</p>
<div class="code highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[simulations.propagator]</span>
<span class="n">type</span> <span class="o">=</span> <span class="s">&quot;MonteCarlo&quot;</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="s">&quot;500 K&quot;</span>

<span class="n">moves</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Translate&quot;</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="s">&quot;1 A&quot;</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mi">2</span><span class="p">},</span>
    <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Rotate&quot;</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="s">&quot;20 deg&quot;</span><span class="p">,</span> <span class="n">molecule</span> <span class="o">=</span> <span class="s">&quot;CO2.xyz&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Resize&quot;</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="s">&quot;10 bar&quot;</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="s">&quot;3 A^3&quot;</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">},</span>
<span class="p">]</span>
</pre></div>
</div>
<div class="section" id="moves">
<h2>Moves<a class="headerlink" href="#moves" title="Permalink to this headline">¶</a></h2>
<p>All <code class="docutils literal notranslate"><span class="pre">moves</span></code> are specified as inline tables. You can add a move using the
<code class="docutils literal notranslate"><span class="pre">type</span></code> key with the name of the move.</p>
<p><code class="docutils literal notranslate"><span class="pre">moves</span></code> accept an optional <code class="docutils literal notranslate"><span class="pre">frequency</span></code> parameter. During a Monte Carlo
simulation it is very important that a move is selected randomly from the whole
set. You can increase the chance to pick a certain move (compared to all other
moves) by assigning a high <code class="docutils literal notranslate"><span class="pre">frequency</span></code> to it.  If you don’t specify a
<code class="docutils literal notranslate"><span class="pre">frequency</span></code>, it is set to one.</p>
<p>Lumol normalizes frequencies after all moves are added. The easiest way to
handle frequencies is to use relative values. We will explain this below in the
given examples.</p>
<p>Some moves can be specified to act on a single molecule or particle type. These
moves accept a <code class="docutils literal notranslate"><span class="pre">molecule</span></code> key whose value is a path to a configuration file
that can be read by <a class="reference external" href="http://chemfiles.org/">chemfiles</a>.</p>
<p>You can add the same move multiple times. For example, you can assign different
amplitudes for different species in a mixture to make sampling more efficient.
You can also use the <code class="docutils literal notranslate"><span class="pre">molecule</span></code> type to freeze a species by assigning a move
for all but the frozen species.</p>
<p>If you specify a molecule, it will be selected with the following algorithm:</p>
<ul class="simple">
<li>Read the first frame of the file;</li>
<li>If the file does not contain any bonding information, try to guess the bonds;</li>
<li>Use the first molecule of the frame.</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">moves</span></code> that use a displacement (<code class="docutils literal notranslate"><span class="pre">delta</span></code>) can be added with the
<code class="docutils literal notranslate"><span class="pre">target_acceptance</span></code> key. After a specific number of times a move was called
(<code class="docutils literal notranslate"><span class="pre">update_frequency</span></code>), we compute the acceptance ratio for the current
<code class="docutils literal notranslate"><span class="pre">delta</span></code> value, <em>i.e.</em> how often the move was accepted versus how often a move
was attempted. If the current acceptance is far away from the
<code class="docutils literal notranslate"><span class="pre">target_acceptance</span></code>, we compute a new value of <code class="docutils literal notranslate"><span class="pre">delta</span></code> based on the current
acceptance. A <code class="docutils literal notranslate"><span class="pre">target_acceptance</span></code> can only be used in conjunction with the
<code class="docutils literal notranslate"><span class="pre">update\_frequency</span></code> key that specifies the frequency between updates.</p>
<p>Sometimes a given acceptance value cannot be achieved. Either due to limits of
the adjusted <code class="docutils literal notranslate"><span class="pre">delta</span></code> value (it makes no sense to rotate a particle by more
than 180° or to translate it by multiple values of the cutoff range) or due to
the nature of the system.</p>
<p>To summarize, using an adjustable displacement, we can increase the efficiency
of our simulation, but strictly speaking we violate detailed balance and
therefore the Markov chain. To make sure you get correct results from your
simulations, we recommend to use adjustable displacements <em>only for
equilibration runs</em>. You can then take the resulting values for <code class="docutils literal notranslate"><span class="pre">delta</span></code> and
use them for a production run, where no further adjustments are made.</p>
<p><strong>Example</strong></p>
<div class="code highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Equilibration of a protein in water.</span>
<span class="k">[simulations.propagator]</span>
<span class="n">type</span> <span class="o">=</span> <span class="s">&quot;MonteCarlo&quot;</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="s">&quot;300 K&quot;</span>
<span class="c1"># we update the maximum displacement `delta` after a move was called 500 times</span>
<span class="n">update_frequency</span> <span class="o">=</span> <span class="mi">500</span>

<span class="n">moves</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># we have much more water in the system so we want to move it more often</span>
    <span class="c1"># hence we set the `frequency = 100`</span>
    <span class="c1"># after 500 calls to this translation move, we adjust `delta` to get to approximately 50% acceptance</span>
    <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Translate&quot;</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="s">&quot;2 A&quot;</span><span class="p">,</span> <span class="n">molecule</span> <span class="o">=</span> <span class="s">&quot;H2O.xyz&quot;</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">target_acceptance</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">},</span>
    <span class="c1"># the single protein will be displaced only by a small distance `delta = &quot;0.05 A&quot;` during the whole run</span>
    <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Translate&quot;</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="s">&quot;0.05 A&quot;</span><span class="p">,</span> <span class="n">molecule</span> <span class="o">=</span> <span class="s">&quot;protein.pdb&quot;</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mi">1</span><span class="p">},</span>
<span class="p">]</span>
</pre></div>
</div>
<div class="section" id="translate">
<span id="mcmove-translate"></span><h3>Translate<a class="headerlink" href="#translate" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Translate</span></code> move changes the position of a single, randomly selected
molecule by adding a random displacement vector to its center of mass.</p>
<ul class="simple">
<li>Needed keys:<ul>
<li><code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">&quot;Translate&quot;</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">delta</span></code> (string): Maximum amplitude for displacement.</li>
</ul>
</li>
<li>Optional keys:<ul>
<li><code class="docutils literal notranslate"><span class="pre">frequency</span></code> (float): Move frequency.</li>
<li><code class="docutils literal notranslate"><span class="pre">molecule</span></code> (string): Select only the specified molecule type.  The
string contains the path to the configuration file of the molecule.</li>
<li><code class="docutils literal notranslate"><span class="pre">target_acceptance</span></code> (float): The target acceptance for this move. Value
has to be greater than zero and smaller than one. Can only be used in
conjunction with <code class="docutils literal notranslate"><span class="pre">update_frequency</span></code>.</li>
</ul>
</li>
</ul>
<p>If the <code class="docutils literal notranslate"><span class="pre">molecule</span></code> key is used, the move will only apply to one molecule type.
If not, the move will apply to all molecule types in the system. The <code class="docutils literal notranslate"><span class="pre">delta</span></code>
key is the maximum magnitude of the translation vector. The conjugated string
contains the value with unit of distance.</p>
<p><strong>Example</strong></p>
<div class="code highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[simulations.propagator]</span>
<span class="n">type</span> <span class="o">=</span> <span class="s">&quot;MonteCarlo&quot;</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="s">&quot;500 K&quot;</span>
<span class="n">moves</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># Define a translation for all molecules in the system, including He.</span>
    <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Translate&quot;</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="s">&quot;1 A&quot;</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mi">2</span><span class="p">},</span>
    <span class="c1"># For He, pick a larger displacement with half the frequency of the</span>
    <span class="c1"># first move. Now there is a 66% chance to pick *any* molecule</span>
    <span class="c1"># and translate it by up to 1 A. There is a 33% chance to pick He (and only He)</span>
    <span class="c1"># and translate it by up to 10 A.</span>
    <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Translate&quot;</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="s">&quot;10 A&quot;</span><span class="p">,</span> <span class="n">molecule</span> <span class="o">=</span> <span class="s">&quot;He.xyz&quot;</span><span class="p">},</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="rotate">
<span id="mcmove-rotate"></span><h3>Rotate<a class="headerlink" href="#rotate" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Rotate</span></code> move randomly rotates a single molecule around its center of
mass.</p>
<ul class="simple">
<li>Needed keys:<ul>
<li><code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">&quot;Rotate&quot;</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">delta</span></code> (string): Maximum angle for rotation.</li>
</ul>
</li>
<li>Optional keys:<ul>
<li><code class="docutils literal notranslate"><span class="pre">frequency</span></code> (float): Move frequency.</li>
<li><code class="docutils literal notranslate"><span class="pre">molecule</span></code> (string): Select only the specified molecule type.  The
string contains the path to the configuration file of the molecule.</li>
<li><code class="docutils literal notranslate"><span class="pre">target_acceptance</span></code> (float): The target acceptance for this move. Value
has to be greater than zero and smaller than one. Can only be used in
conjunction with <code class="docutils literal notranslate"><span class="pre">update_frequency</span></code>.</li>
</ul>
</li>
</ul>
<p>If the <code class="docutils literal notranslate"><span class="pre">molecule</span></code> key is used, the move will only apply to one molecule type.
If not, the move will apply to all molecules in the system. The <code class="docutils literal notranslate"><span class="pre">delta</span></code> key is
the maximum angle. The conjugated string contains the value and the unit of
either radians or degrees (<code class="docutils literal notranslate"><span class="pre">rad</span></code> or <code class="docutils literal notranslate"><span class="pre">deg</span></code>).</p>
<p><strong>Example</strong></p>
<div class="code highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[simulations.propagator]</span>
<span class="n">type</span> <span class="o">=</span> <span class="s">&quot;MonteCarlo&quot;</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="s">&quot;500 K&quot;</span>
<span class="n">moves</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Rotate&quot;</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="s">&quot;3 deg&quot;</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mi">2</span><span class="p">},</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="resize">
<span id="mcmove-resize"></span><h3>Resize<a class="headerlink" href="#resize" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Resize</span></code> move can be used to isotropically change the systems’ volume.</p>
<ul class="simple">
<li>Needed keys:<ul>
<li><code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">&quot;Resize&quot;</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">pressure</span></code> (string): Target pressure.</li>
<li><code class="docutils literal notranslate"><span class="pre">delta</span></code> (string): Amplitude.</li>
</ul>
</li>
<li>Optional keys:<ul>
<li><code class="docutils literal notranslate"><span class="pre">frequency</span></code> (float): Move frequency.</li>
<li><code class="docutils literal notranslate"><span class="pre">target_acceptance</span></code> (float): The target acceptance for this move. Value
has to be greater than zero and smaller than one. Can only be used in
conjunction with <code class="docutils literal notranslate"><span class="pre">update_frequency</span></code>.</li>
</ul>
</li>
</ul>
<p>For a given <code class="docutils literal notranslate"><span class="pre">pressure</span></code>, the volume will fluctuate during the simulation. We
can use this move to sample an isobaric-isothermal ensemble. The <code class="docutils literal notranslate"><span class="pre">delta</span></code> key
sets the maximum amplitude of the volume change in units of cubic length.</p>
<p>By changing the volume, we effectively change all (center of mass) positions at
once. This makes <code class="docutils literal notranslate"><span class="pre">Resize</span></code> moves computationally expensive and we recommend to
use a comparatively low value for the <code class="docutils literal notranslate"><span class="pre">frequency</span></code>.  As a rule of thumb, for a
system containing <span class="math notranslate nohighlight">\(N\)</span> particles, every <span class="math notranslate nohighlight">\(N + 1\)</span>’th move should be a
<code class="docutils literal notranslate"><span class="pre">Resize</span></code> move, since a single volume change is approximately as expensive as
<span class="math notranslate nohighlight">\(N\)</span> particle translations or rotations.</p>
<p><strong>Example</strong></p>
<div class="code highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulation of 500 molecules.</span>
<span class="k">[simulations.propagator]</span>
<span class="n">type</span> <span class="o">=</span> <span class="s">&quot;MonteCarlo&quot;</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="s">&quot;500 K&quot;</span>
<span class="n">moves</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Translate&quot;</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="s">&quot;1 A&quot;</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mi">250</span><span class="p">},</span>
    <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Rotate&quot;</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="s">&quot;20 deg&quot;</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mi">250</span><span class="p">},</span>
    <span class="p">{</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;Resize&quot;</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="s">&quot;10 bar&quot;</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="s">&quot;3 A^3&quot;</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">=</span> <span class="mi">1</span><span class="p">},</span>
<span class="p">]</span>
</pre></div>
</div>
<p>As mentioned above, frequencies are normalized. In this example, 501 moves
consist of 250 translations, 250 rotations and a single resizing of the cell <em>on
average</em> (remember, moves are picked at random with their respective frequency).
Setting up a move set like we did in this example is very convenient and in
literature you’ll often find the term “cycle” (here, 1 cycle = 501 moves) to
describe such a set of moves and respective frequencies.</p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
    </p>
    <p class="pull-left">
        &copy; Lumol contributors
    </p>
    <p class="text-center">
        Available on <a href="https://github.com/lumol-org/lumol">Github</a>
    </p>
  </div>
</footer>

  </body>
</html>